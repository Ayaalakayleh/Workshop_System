@using Microsoft.Extensions.Localization
@using Workshop.Resources


@model List<Workshop.Core.DTOs.ExternalWorkshopExp.MExternalWorkshopExpDTO>

@inject IStringLocalizer<Common> Common
@inject IStringLocalizer<Messages> Message


<div class="row">
    <div class="col-12">
        <div id="panel-1" class="panel">
            <div class="panel-hdr px-2">
                <h2 class="font-weight-bold">@Common["Title_MaintenanceList"]</h2>
            </div>
            <div class="panel-container show">
                <div class="panel-content">
                    <table class="table table-striped table-bordered table-hover dataTables-example dataTable text-center" id="DataTables_Table_0" aria-describedby="DataTables_Table_0_info" role="grid">
                        <thead>
                            <tr>
                                <th>@Common["Label_Id"]</th>
                                <th>@Common["ExternalWorkshop"]</th>
                                <th>@Common["Label_Date"]</th>
                                <th>@Common["Label_Actions"]</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr class="gradeX" id="@item.ID">
                                    <td> @item.ID  </td>
                                    <td> @item.PrimaryName  </td>
                                    <td> @item.Excel_Date.ToShortDateString()</td>
                                    <td>
                                        @* @if (BaseHttpContext.UserHasPermission(Permissions.CollectionEdit)) *@
                                        @if(true)
                                        {
                                            <button class="btn btn-info btn-w-m my-1" onclick="location.href = '@Url.Action("Edit","Collection")/@item.ID'"><i class="fa fa-pencil"></i>&nbsp;@Common["View"]</button>
                                        }

                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    @if (Model.Count > 0)
                    {
                        <input id="total_pages" value="@Math.Ceiling((decimal)Model.ToList()[0].TotalPages / 25)" hidden />
                    }
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/js/site.js"></script>

<script>
    function deleteDamage(c) {

        swal({
            title: "@Common["SwalDeleteTitle"]",
            //popup: 'animate__animated animate__fadeInDown',
            title: "@Common["SwalDeleteTitle"]",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#ed5565",
            cancelButtonColor: "#909090",
            confirmButtonText: "@Common["SwalDeleteConfirm"]",
            cancelButtonText: "@Common["SwalDeleteCancel"]",
            closeOnConfirm: false,
            closeOnCancel: false
        },
            function (isConfirm) {
                if (isConfirm) {
                    $.ajax({
                        type: 'post',
                        url: "/Damage/Delete/" + c,
                        contentType: 'application/json',
                        dataType: 'json',
                        data: {},
                        success: function (data) {
                            if (data == true) {
                                swal("@Common["Deleted"]", "@Common["SwalDeleteText"]", "success");

                                $('#' + c).remove();
                                swal.fire({
                                    hideClass: {
                                        popup: 'animate__animated animate__fadeOutUp'
                                    }
                                })
                            } else {
                                swal("@Common["Error"]", "@Common["SwalCancelText"]", "error");
                            }
                        },
                        error: function () {
                            swal("@Common["Error"]", "@Common["SwalCancelText"]", "error");
                        }
                    });
                } else {
                    swal("@Common["Cancelled"]", "", "error");
                }
            });
    };
</script>
